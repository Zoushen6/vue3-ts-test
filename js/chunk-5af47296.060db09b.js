(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5af47296"],{"253d":function(e,t,n){},"2fc7":function(e,t,n){"use strict";n.r(t);var o=n("ecd8"),a=(n("797a"),n("7a23")),i=n("9ab4"),c={defaultLineStyle:{strokeStyle:"black",lineWidth:2,lineCap:"round",shadowColor:"black",lineJoin:"round"}},r=function(){return/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i.test(window.navigator.userAgent)},l=function(){function e(e){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.lineStyle=Object(i["a"])({},c.defaultLineStyle),this.backgroundColor="",this.isMouseDown=!1,this.hasDrawn=!1,this.setLineStyle(),this.draw()}return e.prototype.draw=function(){var e=this,t=r()?["touchstart","touchmove","touchend"]:["mousedown","mousemove","mouseup","mouseleave"];t.forEach((function(t){e.eventMan(t)}))},e.prototype.setLineStyle=function(e){var t=this;Object.assign(this.lineStyle,e),Object.keys(this.lineStyle).forEach((function(e){t.ctx[e]=t.lineStyle[e]}))},e.prototype.setBackgroundColor=function(e){this.backgroundColor=e},e.prototype.handleEvent=function(){var e=this,t=this.canvas.getBoundingClientRect(),n=t.left,o=t.top,a=r(),i=function(t){if(e.isMouseDown&&1==t.which||a){t=a?t.touches[0]:t;var i={x:t.clientX-n,y:t.clientY-o};e.ctx.lineTo(i.x,i.y),e.ctx.stroke()}},c=function(t){e.ctx.beginPath()},l=function(t){var a={x:t.clientX-n,y:t.clientY-o};e.ctx.lineTo(a.x,a.y),e.ctx.stroke(),e.isMouseDown=!1},s=function(t){t=r()?t.touches[0]:t,e.ctx.beginPath(),e.isMouseDown=!0,e.hasDrawn=!0;var a={x:t.clientX-n,y:t.clientY-o};e.ctx.moveTo(a.x,a.y)};return{handleMove:i,handleDown:s,handleLeave:c,handleUp:l}},e.prototype.eventMan=function(e){var t=this.handleEvent(),n=window.requestAnimationFrame,o=n?function(e){n((function(){t.handleMove(e)}))}:t.handleMove,a={mousedown:t.handleDown,mouseleave:t.handleLeave,mouseup:t.handleUp,mousemove:o,touchmove:o,touchstart:t.handleDown,touchend:t.handleLeave};this.canvas.addEventListener(e,a[e],!1)},e.prototype.clear=function(){var e=this.canvas.width,t=this.canvas.height;this.hasDrawn=!1,this.ctx.clearRect(0,0,e,t)},e.prototype.getPNGImage=function(e){return void 0===e&&(e=this.canvas),e.toDataURL("image/png")},e.prototype.getJPGImage=function(e){return void 0===e&&(e=this.canvas),e.toDataURL("image/jpeg")},e.prototype.generate=function(e){var t=this,n=e&&e.format?e.format:"image/png",o=e&&e.quality?e.quality:1;return new Promise((function(a,i){if(t.hasDrawn){var c=t.ctx.getImageData(0,0,t.canvas.width,t.canvas.height);t.ctx.globalCompositeOperation="destination-over",t.ctx.fillStyle=t.backgroundColor,t.ctx.fillRect(0,0,t.canvas.width,t.canvas.height),t.resultImg=t.canvas.toDataURL(n,o);var r=t.resultImg;if(t.ctx.clearRect(0,0,t.canvas.width,t.canvas.height),t.ctx.putImageData(c,0,0),t.ctx.globalCompositeOperation="source-over",e&&e.isCrop){var l=t.getCropArea(c.data),s=document.createElement("canvas"),u=s.getContext("2d");s.width=l[2]-l[0],s.height=l[3]-l[1];var d=t.ctx.getImageData(l[0],l[1],l[2],l[3]);u.globalCompositeOperation="destination-over",u.putImageData(d,0,0),u.fillStyle=t.backgroundColor,u.fillRect(0,0,s.width,s.height),r=s.toDataURL(n,o)}a(r)}else i("Warning: Not Signned!")}))},e.prototype.getCropArea=function(e){for(var t=this.canvas.width,n=0,o=this.canvas.height,a=0,i=0;i<this.canvas.width;i++)for(var c=0;c<this.canvas.height;c++){var r=4*(i+this.canvas.width*c);(e[r]>0||e[r+1]>0||e[r+2]||e[r+3]>0)&&(a=Math.max(c,a),n=Math.max(i,n),o=Math.min(c,o),t=Math.min(i,t))}t++,n++,o++,a++;var l=[t-10,o-10,n+10,a+10];return l},e}(),s=l,u=Object(a["defineComponent"])({name:"BaseSign",props:{width:{type:Number,default:800},height:{type:Number,default:800},lineWidth:{type:Number,default:4},lineColor:{type:String,default:"#000000"},bgColor:{type:String,default:"#fff"},isCrop:{type:Boolean,default:!1},isClearBgColor:{type:Boolean,default:!0},format:{type:String,default:"image/png"},quality:{type:Number,default:1}},setup:function(e,t){var n=t.expose,o=e;Object(a["watch"])((function(){return o.bgColor}),(function(e){c.value.style.background=o.bgColor,i.setBackgroundColor(o.bgColor)}));var i,c=Object(a["ref"])(),r=function(){i.clear()},l=function(){if(i.hasDrawn){var e=document.createElement("a");e.href=i.getPNGImage(),e.download="canvas-sign.png",e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}},u=function(){i.generate({isCrop:o.isCrop}).then((function(e){console.log(e)})).catch((function(e){console.warn(e)}))};return n({clear:r,download:l,toBase64:u}),Object(a["onMounted"])((function(){c.value.width=o.width,c.value.height=o.height,c.value.style.background=o.bgColor,i=new s(c.value),i.setBackgroundColor(o.bgColor),console.log(i)})),function(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",null,[Object(a["createElementVNode"])("canvas",{ref_key:"canvas",ref:c,"disable-scroll":"true"},null,512)])}}});const d=u;var h=d,f={class:"content"},v=Object(a["createTextVNode"])("清除"),g=Object(a["createTextVNode"])("下载"),p=Object(a["createTextVNode"])("base64"),b=Object(a["defineComponent"])({name:"Sign",setup:function(e){var t=Object(a["ref"])(),n=function(){t.value.clear()},i=function(){t.value.toBase64()},c=function(){t.value.download()};return Object(a["onMounted"])((function(){})),function(e,r){var l=o["a"];return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",f,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(l,{onClick:n},{default:Object(a["withCtx"])((function(){return[v]})),_:1}),Object(a["createVNode"])(l,{onClick:c},{default:Object(a["withCtx"])((function(){return[g]})),_:1}),Object(a["createVNode"])(l,{onClick:i},{default:Object(a["withCtx"])((function(){return[p]})),_:1})]),Object(a["createVNode"])(h,{class:"baseSign",ref_key:"baseSign",ref:t,"bg-color":"#ffffff"},null,512)])}}}),m=(n("2ff2"),n("6b0d")),w=n.n(m);const y=w()(b,[["__scopeId","data-v-16a61cce"]]);t["default"]=y},"2ff2":function(e,t,n){"use strict";n("253d")}}]);